function startCheck(){var t=DATA;markCheck(0,!!t),markCheck(1,!!(t.PWR_Voltage_1&&t.PWR_Voltage_2&&t.PWR_Voltage_1>MIN_VOLTAGE&&t.PWR_Voltage_2>MIN_VOLTAGE)),markCheck(2,!(!t.PWR_Temperature_1||!t.PWR_Temperature_2)),markCheck(3,!!(t.NAV_LTS_Brake_1_2&&t.NAV_LTS_Brake_3_4&&t.NAV_LTS_Brake_1_2>BRAKE_PAD&&t.NAV_LTS_Brake_3_4>BRAKE_PAD)),markCheck(4,!!(t.CTRL_LTS_Height_1_2&&t.CTRL_LTS_Height_3_4&&t.CTRL_LTS_Height_1_2>LEVITATION&&t.CTRL_LTS_Height_3_4>LEVITATION)),markCheck(5,0==t.Nav_Acceleration),markCheck(6,0==t.Nav_Velocity),markCheck(7,t.CTRL_Pressure>MAX_PRESSURE),markCheck(8,t.CTRL_Temperature>NOM_TEMP),count==checks.length&&$("#health-display").append('<p  class="check-item">All Health Checks Passed. Pod is ready for Launch! </p>')}function markCheck(t,e){e&&count++,$("#chk"+t+" .status").html(e?"check":"close").css({color:e?"green":"red"})}function loadSVG(t,e){var a=new XMLHttpRequest;a.open("get","img/"+t,!0),a.onreadystatechange=function(){if(4==a.readyState){var t=a.responseXML.documentElement;t=document.importNode(t,!0),$("#"+e).append(t)}},a.send()}function PositionIndicator(t){for(var e in t)this[e]=t[e]}function Slider(t){for(var e in t)this[e]=t[e];var a=this,i="#"+a.id+" .range-value";$("#"+this.id).slider({range:"min",max:a.max,min:a.min,value:0,slide:function(t,e){$(i).val(e.value)}}),$(i).change(function(){$(i).val()<=a.max&&$(i).val()>=a.min&&$("#"+a.id).slider("value",$(i).val())})}function SpeedGauge(t){for(var e in t)this[e]=t[e]}function deg2rad(t){return t*(Math.PI/180)}function rad2deg(t){return t*(180/Math.PI)}function update(t){isNaN(t.comm_primary)?$("#primary-channel").removeClass():$("#primary-channel").removeClass().addClass("connected"),isNaN(t.comm_secondary)?isNaN(t.comm_secondary):$("#secondary-channel").removeClass().addClass("connected"),$("#secondary-channel").removeClass(),$("#current-channel").text(t.comm_current),isNaN(t.Team_Id)||$("#team_id").text(parseFloat(t.Team_Id)),isNaN(t.Status_pod)||$("#pod-status").text(pod_state[t.Status_pod]),t.console_entry&&$(".console .display").append('<p class="console-entry">['+t.timestamp+"] "+t.console_entry+"</p>");for(var e=1;e<=2;e++){var i=$("#b-p"+e);i.find(".temp").text(t.PWR_Temperature),i.find(".current").text(t.PWR_Current),i.find(".voltage").text(t.PWR_Voltage),i.find(".battery").removeClass().addClass("battery soc--4")}if(isNaN(t.CTRL_Temperature)||$("#temperature").text(t.CTRL_Temperature),isNaN(t.CTRL_Pressure)||$("#pressure").text(t.CTRL_Pressure),isNaN(t.Nav_RR_Strip_Count)||p.updateStripCount(t.Nav_RR_Strip_Count),isNaN(t.Nav_Position)||p.updatePosition(t.Nav_Position),isNaN(t.Nav_Velocity)||v.setStatValue(t.Nav_Velocity),isNaN(t.Nav_Acceleration)||a.setStatValue(t.Nav_Acceleration),isNaN(t.Nav_Yaw)||yaw.setValueAnimated(t.Nav_Yaw,.5),isNaN(t.Nav_Pitch)||pitch.setValueAnimated(t.Nav_Pitch,.5),isNaN(t.Nav_Roll)||roll.setValueAnimated(t.Nav_Roll,.5),isNaN(t.CTRL_LTS_Height_1_2)||$("#lev1").text(t.CTRL_LTS_Height_1_2),isNaN(t.CTRL_LTS_Height_3_4)||$("#lev2").text(t.CTRL_LTS_Height_3_4),!isNaN(t.Nav_LTS_Brake_1_2)&&!isNaN(t.Nav_LTS_Brake_3_4)){var s=(t.Nav_LTS_Brake_1_2+t.Nav_LTS_Brake_3_4)/2;$("#brake-pad").text(s)}}function sendCommand(t,e){socket.emit("pod_command",commands[t]),"Braking"!=t&&"LowSpeedDrive"!=t||(console.log(t),console.log(e),isNaN(e)||socket.emit("pod_command",e))}$("input:checkbox").change(function(){$(this).is(":checked")?($(this).closest("div").addClass("checked").trigger("switch"),null!=$(this).closest("div").attr("command")&&sendCommand($(this).closest("div").attr("on-command"))):($(this).closest("div").removeClass("checked").trigger("switch"),null!=$(this).closest("div").attr("command")&&sendCommand($(this).closest("div").attr("off-command")))}),$(".controls .switch input#controls-toggle").change(function(){$(".controls .collapsible").collapsible("open",0)}),$("button[command=true").click(function(){sendCommand($(this).attr("commandByte"))}),$(".battery").each(function(t){for(var e=1;e<=4;e++)$(this).append('<div class="bar">')});var Gauge=window.Gauge,yaw=Gauge(document.getElementById("yaw"),{max:360,dialStartAngle:-90,dialEndAngle:-90.001,value:0,label:function(t){return t+String.fromCharCode(176)}}),pitch=Gauge(document.getElementById("pitch"),{max:360,dialStartAngle:-90,dialEndAngle:-90.001,value:0,label:function(t){return t+String.fromCharCode(176)}}),roll=Gauge(document.getElementById("roll"),{max:360,dialStartAngle:-90,dialEndAngle:-90.001,value:0,label:function(t){return t+String.fromCharCode(176)}}),all_checks=["Computer Mode Operational","Telemetry Stream Active","Emergency brakes - disengaged","UI reading of Pod relay state","Battery packs sufficiently charged.","UI reading of Battery temperature","Brake pads are still at 32 mm","Levitation module is at 45 mm","Zero acceleration in all axes","Zero velocity in all axes","External pressure is 860Pa","Nominal temperatures","SpaceX Pusher Status - Ready"],checks=["Telemetry Stream Active","Battery packs sufficiently charged.","UI reading of Battery temperature","Brake pads are still at 32 mm","Levitation module is at 45 mm","Zero acceleration in all axes","Zero velocity in all axes","External pressure is 860Pa","Nominal temperatures"],MIN_VOLTAGE=.1,BRAKE_PAD=32,LEVITATION=45,MAX_PRESSURE=860,NOM_TEMP=30;for(var i in checks)$("#health-display").append('<div class="check-item" id="chk'+i+'"><i class="status material-icons">cached</i><span class="check-item-name">'+checks[i]+"</span></div>");$("#start-check").click(function(){setTimeout(function(){startCheck()},400)});var count;$("#left-sidebar-control").sideNav({edge:"left",closeOnClick:!1,draggable:!1,onOpen:function(t){},onClose:function(t){}}),$("#right-sidebar-control").sideNav({edge:"right",closeOnClick:!1,draggable:!1,onOpen:function(t){},onClose:function(t){}}),console.log($(window).width()),loadSVG("levitation.svg","levitation-distance"),loadSVG("brake-pad.svg","brake-pad-distance"),PositionIndicator.prototype.init=function(){for(var t='<section class="position-indicator-container"'+this.id+'><div class="position-indicator '+this.id+'"><div class="outer-ring '+this.id+'">',e=0;e<41;e++)t+='<span class="tick '+this.id+'"></span>';t+='</div><div class="details '+this.id+'">',t+='<p class="count-label '+this.id+'">'+this.count_label+' <span class="count"> '+this.count+'</span></p><p class="label '+this.id+'">'+this.label+'</p><p class="value '+this.id+'">'+this.value+'</p><p class="unit '+this.id+'">'+this.unit+"</p></div></section>",$("#"+this.id).append(t),this.addCSS()},PositionIndicator.prototype.addCSS=function(){this.ticks=$(".tick."+this.id),this.details=$(".details."+this.id),this.outerRingRadius=85;var t=this;this.ticks.each(function(e){var a=210-6*e,i=deg2rad(a),s=t.outerRingRadius,n=["translate("+Math.cos(i)*s+"px, "+Math.sin(i)*-s+"px)","rotate("+-a+"deg)"].join(" ");$(this).css({"-webkit-transform":n,"-moz-transform":n,transform:n})}),this.updateStripCount(),this.updatePosition()},PositionIndicator.prototype.updateStripCount=function(t){t&&(this.count=t);var e=this;this.ticks.each(function(t){t+1<=e.count?$(this).css({"border-color":"#fff"}):$(this).css({"border-color":"#3b3d45"})}),this.details.find(".count").text(this.count)},PositionIndicator.prototype.updatePosition=function(t){t&&(this.value=t),this.details.find(".value").text(this.value)};var p=new PositionIndicator({id:"position",label:"Position",unit:"m",value:0,count:0,count_label:"Strip"});p.init();var brakes=new Slider({id:"range1",max:100,min:0}),aux=new Slider({id:"range2",max:100,min:0});$("#range1 input").change(function(){sendCommand("Braking",$(this).val())}),$("#range2 input").change(function(){sendCommand("LowSpeedDrive",$(this).val())}),SpeedGauge.prototype.initGauge=function(){for(var t='<section class="speedometer-container"'+this.id+'><div class="speedometer '+this.id+'"><div class="inner-ring '+this.id+'"></div><div class="outer-ring '+this.id+'">',e=0;e<49;e++)t+='<span class="tick '+this.id+'"></span>';t+='</div><div class="digit-ring '+this.id+'">';for(e=1;e<=9;e++)t+='<span class="digit '+this.id+'">'+20*(e-1)+"</span>";t+='</div><div class="details '+this.id+'">',t+='<p class="label '+this.id+'">'+this.label+'</p><p class="speed '+this.id+'">'+this.value+'</p><p class="unit '+this.id+'">'+this.unit+'</p></div><div class="guage-progress '+this.id+'"></div></section>',$("#"+this.id).append(t),this.addCSS()},SpeedGauge.prototype.addCSS=function(){this.ticks=$(".tick."+this.id),this.digits=$(".digit."+this.id),this.details=$(".details."+this.id),this.progress=$(".guage-progress."+this.id),this.outerRingRadius=85,this.digitRingRadius=65;var t=this;this.ticks.each(function(e){var a=210-5*e,i=deg2rad(a),s=t.outerRingRadius+(e%6?0:4),n=["translate("+Math.cos(i)*s+"px, "+Math.sin(i)*-s+"px)","rotate("+-a+"deg)"].join(" ");$(this).css({"-webkit-transform":n,"-moz-transform":n,transform:n})}),this.digits.each(function(e){var a=deg2rad(210-30*e),i=Math.cos(a)*t.digitRingRadius,s=Math.sin(a)*-t.digitRingRadius;$(this).css({"-webkit-transform":"translate("+i+"px, "+s+"px)","-moz-transform":"translate("+i+"px, "+s+"px)",transform:"translate("+i+"px, "+s+"px)"})}),this.frameCount=100,this.frameInterval=.3,this.digitValueMax=160,this.statValueMax=this.value,this.statValueCurrent=0,this.statValueInterval=this.statValueMax/this.frameCount,this.updateDetails()},SpeedGauge.prototype.updateDetails=function(){if(!(this.statValueCurrent.toFixed(1)>this.statValueMax)){this.setStatValue(this.statValueCurrent.toFixed(1)),this.statValueCurrent+=this.statValueInterval;var t=this;setTimeout(function(){t.updateDetails()},this.frameInterval)}},SpeedGauge.prototype.setStatValue=function(t){var e=t/this.digitValueMax*240-120;this.progress.css({transform:"rotate("+e+"deg)"}),this.details.find(".speed").text(t)};var v=new SpeedGauge({id:"velocity",label:"Velocity",unit:"m/s",value:.1});v.initGauge();var a=new SpeedGauge({id:"acceleration",label:"Acceleration",unit:"m/s/s",value:.1});a.initGauge(),v.setStatValue(0),a.setStatValue(0);var pod_state=["LVElec","Idle","Ready","AwaitPusherAttach","Pushing","LevAndBraking","DescAndBrakeRetr","Rolling","LSD","PodStop","EmStop","Fault","EB0","EB1","EB2","PowerOff"],DATA,socket;setTimeout(function(){(socket=io.connect()).on("connect",function(){console.log("Connected!")}),socket.on("data_send",function(t){update(t),DATA=t})},1500);var commands={LinActUp:0,LinActDown:1,LowSpeedDrive:2,Braking:3,ClutchEng:4,ClutchDiseng:5,EmBrake:6,GoOnline:7,PowerOn:8};
//# sourceMappingURL=script.min.js.map
